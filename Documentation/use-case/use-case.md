# Use Case
## Открытие приложения

|№ шага| Действующее лицо | Шаг/Действие|
|-|-|-|
| 1 | Пользователь | Открывает приложение. |
| 2 | Система | Проверяет была ли осуществлена авторизация до этого, если да, то активируется альтернативный сценарий 1, если нет, то переводит Пользователя в окно "Авторизация". |
| 3 | Пользователь | Заполняет все поля формы авторизации. |
| 4 | Система | Проверяет наличие подключения к сети. |
| 4.1 | Система | Если подключения нет, то открывает окно "Предупреждение" с просьбой попробовать авторизоваться снова, когда появится подключение. |
| 4.2 | Система | Если подключение есть, то отправляет введенные данные для входа на сервер. |
| 4.2.1 | Система | Если введенные Пользователем данные неверны, то открывает окно "Предупреждение" с просьбой заполнить форму авторизации еще раз, возвращаясь к шагу 3. | 
| 4.2.2 | Система | Если данные приняты, то просит Пользователя придумать и ввести PIN-код. |
| 5 | Пользователь | Вводит PIN-код. |
| 6 | Система | Шифрует введеные данные для входа при помощи введеного PIN-кода, сохраняет зашифрованные данные и переводит Пользователя на окно "Инструкция". |

### Альтернативный сценарий 1

|№ шага | Действующее лицо | Шаг/Действие|
|-|-|-|
| 3 | Система | Просит Пользователя ввести PIN-код. |
| 4 | Пользователь | Вводит PIN-код. |
| 5 | Система | Проверяет наличее подключения к сети. |
| 5.1 | Система | Если подключения нет, то открывает окно "Предупреждение" с просьбой попробовать авторизоваться снова, когда появится подключение. |
| 5.2 | Система | Если подключение есть, дешифрует данные для входа и отправляет на сервер тестовый запрос. |
| 5.2.1 | Система | Если сервер в ответ отправил ошибку авторизации, то открывает окно "Предупреждение" с просьбой Пользователю ввести PIN-код еще раз, возвращаясь к шагу 4 данного сценария. |
| 5.2.2 | Система | Если сервер принял входные данные, то переводит Пользователя в окно "Список задач". |

## Синхронизация данных

Пользователь находится в окне "Список задач"

|№ шага|Действующее лицо|Шаг/Действие|
|-|-|-|
| 1 | Пользователь | Нажимает на кнопку "Синхронизация с сервером". |
| 2 | Система | Проверяет наличие поключения к сети. |
| 2.1 | Система | Если подключения нет, то открывает окно "Предупреждение" о невозможности синхронизации. |
| 2.1 | Система | Если подключение есть, то проверяет версию данных на сервере. |
| 2.1.1 | Система | Если версия совпадает с локальной, то загружает на сервер свои данные. |
| 2.1.2 | Система | Если локальная и серверная версии отличаются, то открывает окно "Предупреждение" с уведомлением об этом и производит синхронизацию данных с сервером согласно выбранному Пользователем приоритету. |

## Создание задачи/редактирование задачи 

Пользователь находится в окне "Список задач"

|№ шага|Действующее лицо|Шаг/Действие|
|-|-|-|
| 1 | Пользователь | Нажимает на кнопку "Добавить задачу" или "Редактирование задачи" |
| 2 | Система | Переводит Пользователя на окно "Форма редактирования задач", при этом блокируя доступ к взаимодействию с окном "Список задач"/"Диаграмма Ганта"|
| 3 | Пользователь | Заполняет все поля, нажимает кнопку "Сохранить данные". |
| 4 | Система | Проверяет, заполнил ли Пользователь все обязательные поля. |
| 4.1 | Система | Если есть незаполненные поля, открывает окно "Предупреждение" с уведомлением об этом и просьбой заполнить их. Возвращение к 3 шагу. |
| 4.2 | Система | Если все обязательные поля заполнены, то сохраняет все введенные данные. |
| 5 | Пользователь | Нажимает на кнопку "Закрыть окно". |
| 6 | Система | Если остались несохраненные данные, то открывает окно "Предупреждение" с уведомлением о взможной потерей данных и просьбой Пользователя подтвердить дейсвие.|
| 7 | Пользователь | Подверждает закрытие. |
| 8 | Система | Закрывает окно "Форма редактирования задач", при этом снимает блокировку доступа на взаимодействия с окном "Список задач"/"Диаграмма Ганта". |

Если Пользователь закрывает приложение, находясь в окне редактирования, то все несохраненные данные будут утеряны.

## Удаление сервера 

Пользователь находится в окне "Настройки"

|№ шага|Действующее лицо|Шаг/Действие|
|-|-|-|
| 1 | Пользователь | Нажимает на кнопку "Удалить сервер". |
| 2 | Система | Проверяет является ли удаляемый сервер основным (nextcloud). |
| 2.1 | Система | Если удаляемый сервер основной, то открывает окно "Предупреждение" с уведомлением Пользователя о невозможности удаления сервера. |
| 2.2 | Система | Если удаляемый сервер не является основным, то проверяет, является ли он активным. |
| 2.2.1 | Система | Если сервер активен, то открывает окно "Предупреждение" с уведомлением Пользователя о возможной потере данных и просьбой перед удалением синхронизировать данные и сменить активный сервер.|
| 2.2.2 | Система | Если удаляемый сервер не является активным, то удаляет все имеющиеся данные, связанные с данным сервером и обновляет комбобокс. |

## Добавление сервера

Пользователь находится в окне "Настройки"

|№ шага|Действующее лицо|Шаг/Действие|
|-|-|-|
| 1 | Пользователь | Вводит логин и пароль от нового сервера и нажимает кнопку "Подключить". |
| 2 | Система | Проверяет наличие подключения к сети. |
| 2.1 | Система | Если подключения нет, то открывает окно "Предупреждение" с уведомлением об отсутствии подключения и просьбой попробовать подключить сервер снова, когда появится подключение. |
| 2.2 | Система | Если подключение есть, то отправляет введенные данные для входа на сервер. |
| 2.2.1 | Система | Если введенные Пользователем данные неверны, то открывает окно "Предупреждение" с уведомленем для Пользователя о неверности введенных данных и просьбой проверить правильность введенных данных и попробовать снова, возвращаясь к шагу 1. |
| 2.2.2 | Система | Если данные приняты, то сохраняет их для подключения, производит загрузку данных с подключенного сервера и обновляет комбобокс. |

## Удаление задачи

Пользователь находится в окне "Список задач".

|№ шага|Действующее лицо|Шаг/Действие|
|-|-|-|
| 1 | Пользователь | Нажимает на кнопку "Удалить задачу". |
| 2 | Система | Проверяет, имеет ли удаляемая задача подзадачи. |
| 2.1 | Система | Если подзадач нет, то удаляет эту задачу. |
| 2.2 | Система | Если подзадачи имеются, то открывает окно "Предупреждение" с предупреждением о возможной потери данных и просьбой подтвердить действие. |
| 3 | Пользователь | Подтверждает удаление или отменяет его. |
| 4 | Система | Если Пользователь подтвердил удаление, то удаляет эту задачу и все связанные подзадачи. |

## Обновление PIN-кода
 
Пользователь находится в окне "Настройки"
 
|№ шага| Действующее лицо | Шаг/Действие|
|-|-|-|
| 1 | Пользователь | Вводит текущий и новый PIN-коды в поле для смены PIN-кода. |
| 2 | Система | Проверяет введенный текущий PIN-коды.|
| 2.1 | Система | Введен неверно - открывает окно "Предупреждение" с уведомление об этом. |
| 2.2 | Система | Введен верно - расшифроввывает данные для входа старым PIN-кодом и шифрует новым, уведомляет Пользователя о успешной смене PIN-кода.|
